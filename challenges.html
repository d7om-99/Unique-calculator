<!DOCTYPE html>
<html lang="ar">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>ØªØ­Ø¯ÙŠØ§Øª ÙˆÙ…Ø³Ø§Ø¨Ù‚Ø§Øª - Ù…Ø³Ø§Ø¹Ø¯ Ø°ÙƒÙŠ</title>
<style>
  body {
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    background: #121212;
    color: #eee;
    margin: 0; padding: 0;
    direction: rtl;
    display: flex; flex-direction: column; min-height: 100vh;
  }
  header {
    background: #009688;
    padding: 15px;
    font-size: 1.6rem;
    text-align: center;
    font-weight: bold;
  }
  main {
    flex: 1;
    padding: 15px;
    max-width: 800px;
    margin: 0 auto;
  }
  h2 {
    text-align: center;
    margin-bottom: 20px;
  }
  .challenge-list {
    display: flex;
    flex-direction: column;
    gap: 15px;
  }
  .challenge-item {
    background: #222;
    border-radius: 10px;
    padding: 15px;
  }
  .challenge-title {
    font-size: 1.3rem;
    font-weight: bold;
  }
  .challenge-desc {
    margin: 10px 0;
    font-size: 1rem;
  }
  button.start-btn {
    background: #00bfa5;
    border: none;
    color: #000;
    padding: 10px 18px;
    font-weight: bold;
    border-radius: 10px;
    cursor: pointer;
    transition: background 0.3s ease;
  }
  button.start-btn:hover {
    background: #008f7a;
  }
  /* Ø§Ù„ØªÙ‚Ø¯Ù… */
  .progress {
    margin-top: 10px;
    font-size: 0.9rem;
  }
  /* Ù…ÙŠØ¯Ø§Ù„ÙŠØ§Øª */
  .medals {
    margin-top: 10px;
  }
  .medal {
    display: inline-block;
    background: gold;
    color: black;
    padding: 5px 12px;
    border-radius: 15px;
    margin-right: 8px;
    font-weight: bold;
    font-size: 0.9rem;
  }
  /* Ù†Ø§ÙØ°Ø© Ø§Ù„ØªØ­Ø¯ÙŠ */
  #challengeArea {
    background: #222;
    padding: 15px;
    border-radius: 10px;
    margin-top: 25px;
    display: none;
    flex-direction: column;
  }
  #challengeArea h3 {
    margin-bottom: 10px;
  }
  #challengeContent {
    margin-bottom: 15px;
  }
  #challengeQuestion {
    background: #111;
    padding: 10px;
    border-radius: 10px;
    margin-bottom: 15px;
  }
  #challengeAnswer {
    padding: 10px;
    width: 100%;
    border-radius: 10px;
    border: none;
    font-size: 1rem;
  }
  button#submitAnswer {
    margin-top: 10px;
    padding: 10px 18px;
    background: #00bfa5;
    border: none;
    border-radius: 10px;
    font-weight: bold;
    cursor: pointer;
    color: #000;
  }
  button#submitAnswer:hover {
    background: #008f7a;
  }
  #backToList {
    margin-top: 20px;
    background: #444;
    border: none;
    border-radius: 10px;
    padding: 8px 15px;
    cursor: pointer;
    font-weight: bold;
    color: #eee;
    align-self: flex-start;
  }
  #backToList:hover {
    background: #666;
  }
  /* Ù„ÙˆØ­Ø© Ø§Ù„Ù…ØªØµØ¯Ø±ÙŠÙ† */
  #leaderboard {
    margin-top: 25px;
    background: #222;
    border-radius: 10px;
    padding: 15px;
  }
  #leaderboard h3 {
    margin-bottom: 10px;
    text-align: center;
  }
  #leaderboard ol {
    padding-left: 20px;
  }
  #leaderboard li {
    margin-bottom: 6px;
    font-size: 1rem;
  }

  /* ØªÙ†Ø¨ÙŠÙ‡Ø§Øª */
  #notifications {
    background: #333;
    border-radius: 10px;
    padding: 12px;
    margin-bottom: 20px;
    font-size: 1rem;
    color: #ffeb3b;
    font-weight: bold;
    text-align: center;
  }

  /* Ù…ØªØ¬Ø§ÙˆØ¨ */
  @media(max-width:600px) {
    main {
      padding: 10px;
      margin: 0 5px;
    }
  }
</style>
</head>
<body>

<header>ğŸ† ØªØ­Ø¯ÙŠØ§Øª ÙˆÙ…Ø³Ø§Ø¨Ù‚Ø§Øª - Ù…Ø³Ø§Ø¹Ø¯ Ø°ÙƒÙŠ</header>
<main>
  <div id="notifications" style="display:none;"></div>
  <h2>Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„ØªØ­Ø¯ÙŠØ§Øª</h2>
  <div class="challenge-list" id="challengeList">
    <!-- ØªØ¸Ù‡Ø± Ø§Ù„ØªØ­Ø¯ÙŠØ§Øª Ù‡Ù†Ø§ -->
  </div>

  <div id="challengeArea">
    <h3 id="challengeTitle"></h3>
    <div id="challengeContent"></div>
    <div id="challengeQuestion"></div>
    <input type="text" id="challengeAnswer" placeholder="Ø§ÙƒØªØ¨ Ø¬ÙˆØ§Ø¨Ùƒ Ù‡Ù†Ø§" autocomplete="off" />
    <button id="submitAnswer">Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø¬ÙˆØ§Ø¨</button>
    <button id="backToList">Ø§Ù„Ø¹ÙˆØ¯Ø© Ù„Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„ØªØ­Ø¯ÙŠØ§Øª</button>
  </div>

  <div id="leaderboard">
    <h3>Ù„ÙˆØ­Ø© Ø§Ù„Ù…ØªØµØ¯Ø±ÙŠÙ†</h3>
    <ol id="leaderboardList"></ol>
  </div>
</main>

<script>
// Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„ØªØ­Ø¯ÙŠØ§Øª
const challenges = [
  {
    id: 'saving',
    title: 'ØªØ­Ø¯ÙŠ Ø§Ù„Ø§Ø¯Ø®Ø§Ø± Ø§Ù„Ø´Ù‡Ø±ÙŠ',
    description: 'Ø¯ÙˆÙ‘Ù† Ù…ØµØ§Ø±ÙŠÙÙƒ ÙˆÙ‚Ù„Ù„Ù‡Ø§ ØªØ¯Ø±ÙŠØ¬ÙŠØ§Ù‹ ÙƒÙ„ Ø£Ø³Ø¨ÙˆØ¹.',
    steps: [
      {text: 'Ø£Ø³Ø¨ÙˆØ¹ 1: ÙƒÙ… ÙƒØ§Ù† Ù…Ø¬Ù…ÙˆØ¹ Ù…ØµØ§Ø±ÙŠÙÙƒØŸ', check: val => !isNaN(parseFloat(val)) && parseFloat(val)>=0},
      {text: 'Ø£Ø³Ø¨ÙˆØ¹ 2: Ù‡Ù„ Ø­Ø§ÙˆÙ„Øª ØªÙ‚Ù„ÙŠÙ„ Ø§Ù„Ù…ØµØ§Ø±ÙŠÙØŸ (Ù†Ø¹Ù…/Ù„Ø§)', check: val => ['Ù†Ø¹Ù…','Ù„Ø§'].includes(val.trim().toLowerCase())},
      {text: 'Ø£Ø³Ø¨ÙˆØ¹ 3: ÙƒÙ… ØªÙ…ÙƒÙ†Øª Ù…Ù† Ø§Ù„ØªÙˆÙÙŠØ±ØŸ', check: val => !isNaN(parseFloat(val)) && parseFloat(val)>=0},
      {text: 'Ø£Ø³Ø¨ÙˆØ¹ 4: Ù‡Ù„ Ø­Ù‚Ù‚Øª Ù‡Ø¯Ù Ø§Ù„Ø§Ø¯Ø®Ø§Ø±ØŸ (Ù†Ø¹Ù…/Ù„Ø§)', check: val => ['Ù†Ø¹Ù…','Ù„Ø§'].includes(val.trim().toLowerCase())}
    ],
    reward: 'Ù…ÙŠØ¯Ø§Ù„ÙŠØ© Ø§Ù„Ø§Ø¯Ø®Ø§Ø±'
  },
  {
    id: 'skills',
    title: 'ØªØ­Ø¯ÙŠ ØªØ·ÙˆÙŠØ± Ø§Ù„Ù…Ù‡Ø§Ø±Ø§Øª',
    description: 'Ø£ÙƒÙ…Ù„ Ø³Ù„Ø³Ù„Ø© Ø¯Ø±ÙˆØ³ ÙˆØªÙ…Ø§Ø±ÙŠÙ† Ø¨Ø±Ù…Ø¬ÙŠØ© Ø®Ù„Ø§Ù„ ÙØªØ±Ø© Ø²Ù…Ù†ÙŠØ©.',
    steps: [
      {text: 'ÙƒÙ… Ø¯Ø±Ø³ Ø¨Ø±Ù…Ø¬ÙŠ Ø£ÙƒÙ…Ù„ØªØŸ', check: val => !isNaN(parseInt(val)) && parseInt(val)>=0},
      {text: 'Ù‡Ù„ Ø­Ø§ÙˆÙ„Øª ØªØ·Ø¨ÙŠÙ‚ Ù…Ø§ ØªØ¹Ù„Ù…ØªÙ‡ØŸ (Ù†Ø¹Ù…/Ù„Ø§)', check: val => ['Ù†Ø¹Ù…','Ù„Ø§'].includes(val.trim().toLowerCase())},
      {text: 'Ù‡Ù„ Ù‚Ù…Øª Ø¨Ø­Ù„ ØªÙ…Ø§Ø±ÙŠÙ† Ø¨Ø±Ù…Ø¬ÙŠØ©ØŸ (Ù†Ø¹Ù…/Ù„Ø§)', check: val => ['Ù†Ø¹Ù…','Ù„Ø§'].includes(val.trim().toLowerCase())},
      {text: 'Ù‡Ù„ ØªØ´Ø¹Ø± Ø¨ØªØ­Ø³Ù† ÙÙŠ Ù…Ù‡Ø§Ø±Ø§ØªÙƒØŸ (Ù†Ø¹Ù…/Ù„Ø§)', check: val => ['Ù†Ø¹Ù…','Ù„Ø§'].includes(val.trim().toLowerCase())}
    ],
    reward: 'Ù…ÙŠØ¯Ø§Ù„ÙŠØ© Ø§Ù„Ù…Ù‡Ø§Ø±Ø§Øª'
  }
];

// Ø­ÙØ¸ ÙˆØªØ­Ù…ÙŠÙ„ ØªÙ‚Ø¯Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ù…Ù† Ø§Ù„ØªØ®Ø²ÙŠÙ† Ø§Ù„Ù…Ø­Ù„ÙŠ
function saveProgress() {
  localStorage.setItem('challengeProgress', JSON.stringify(challengeProgress));
}
function loadProgress() {
  const data = localStorage.getItem('challengeProgress');
  if(data) challengeProgress = JSON.parse(data);
  else challengeProgress = {};
}

// Ø§Ù„ØªÙ‚Ø¯Ù… Ø§Ù„Ø­Ø§Ù„ÙŠ Ù„Ù„Ù…Ø³ØªØ®Ø¯Ù…
let challengeProgress = {};
loadProgress();

// Ø¹Ø±Ø¶ Ø§Ù„ØªØ­Ø¯ÙŠØ§Øª
const challengeListDiv = document.getElementById('challengeList');
const challengeArea = document.getElementById('challengeArea');
const challengeTitle = document.getElementById('challengeTitle');
const challengeContent = document.getElementById('challengeContent');
const challengeQuestion = document.getElementById('challengeQuestion');
const challengeAnswer = document.getElementById('challengeAnswer');
const submitAnswerBtn = document.getElementById('submitAnswer');
const backToListBtn = document.getElementById('backToList');
const notifications = document.getElementById('notifications');
const leaderboardList = document.getElementById('leaderboardList');

function renderChallenges() {
  challengeListDiv.innerHTML = '';
  challenges.forEach(ch => {
    const progress = challengeProgress[ch.id] || {step: 0, done: false};
    let status = progress.done ? 'âœ… ØªÙ… Ø§Ù„Ø§Ù†ØªÙ‡Ø§Ø¡' : `ÙÙŠ Ø§Ù„Ø®Ø·ÙˆØ© ${progress.step + 1} Ù…Ù† ${ch.steps.length}`;
    challengeListDiv.insertAdjacentHTML('beforeend', `
      <div class="challenge-item">
        <div class="challenge-title">${ch.title}</div>
        <div class="challenge-desc">${ch.description}</div>
        <div class="progress">Ø§Ù„Ø­Ø§Ù„Ø©: ${status}</div>
        <div class="medals">${progress.done ? `<span class="medal">${ch.reward}</span>` : ''}</div>
        <button class="start-btn" onclick="startChallenge('${ch.id}')">${progress.done ? 'Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„ØªØ­Ø¯ÙŠ' : 'Ø§Ø¨Ø¯Ø£ Ø§Ù„ØªØ­Ø¯ÙŠ'}</button>
      </div>
    `);
  });
  renderLeaderboard();
}

// Ø¨Ø¯Ø¡ ØªØ­Ø¯ÙŠ
let currentChallenge = null;
function startChallenge(id) {
  currentChallenge = challenges.find(ch => ch.id === id);
  if(!currentChallenge) return;
  challengeListDiv.style.display = 'none';
  challengeArea.style.display = 'flex';
  challengeTitle.textContent = currentChallenge.title;
  challengeContent.textContent = currentChallenge.description;
  showQuestion();
}

// Ø¹Ø±Ø¶ Ø§Ù„Ø³Ø¤Ø§Ù„ Ø§Ù„Ø­Ø§Ù„ÙŠ Ù…Ø¹ Ø³Ø¤Ø§Ù„ ØªØ­Ù‚Ù‚ Ù…ÙØ§Ø¬Ø¦ Ø¹Ø´ÙˆØ§Ø¦ÙŠ Ø£Ø­ÙŠØ§Ù†Ø§Ù‹
function showQuestion() {
  const progress = challengeProgress[currentChallenge.id] || {step: 0, done: false};
  const stepIndex = progress.step || 0;
  if(stepIndex >= currentChallenge.steps.length) {
    completeChallenge();
    return;
  }

  // Ø£Ø³Ø¦Ù„Ø© ØªØ­Ù‚Ù‚ Ø¹Ø´ÙˆØ§Ø¦ÙŠØ© (30% Ø§Ø­ØªÙ…Ø§Ù„)
  if(Math.random() < 0.3) {
    challengeQuestion.textContent = "Ø³Ø¤Ø§Ù„ ØªØ­Ù‚Ù‚: Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ø¥Ø¬Ø§Ø¨ØªÙƒØŸ Ø£Ø¹Ø¯ Ø§Ù„ØªÙÙƒÙŠØ± Ù‚Ø¨Ù„ Ø§Ù„Ø¥Ø±Ø³Ø§Ù„.";
  } else {
    challengeQuestion.textContent = currentChallenge.steps[stepIndex].text;
  }
  challengeAnswer.value = '';
  challengeAnswer.focus();
}

// Ø¥Ø±Ø³Ø§Ù„ Ø¬ÙˆØ§Ø¨ Ø§Ù„Ø³Ø¤Ø§Ù„
submitAnswerBtn.onclick = () => {
  const val = challengeAnswer.value.trim();
  if(!val) {
    alert("Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø¥Ø¯Ø®Ø§Ù„ Ø¬ÙˆØ§Ø¨.");
    return;
  }
  const progress = challengeProgress[currentChallenge.id] || {step: 0, done: false};
  const stepIndex = progress.step || 0;
  if(!currentChallenge.steps[stepIndex].check(val)) {
    alert("Ø§Ù„Ø¬ÙˆØ§Ø¨ ØºÙŠØ± ØµØ­ÙŠØ­ØŒ Ø­Ø§ÙˆÙ„ Ù…Ø±Ø© Ø£Ø®Ø±Ù‰.");
    return;
  }
  // ØªØ­Ø¯ÙŠØ« Ø§Ù„ØªÙ‚Ø¯Ù…
  challengeProgress[currentChallenge.id] = {step: stepIndex + 1, done: false};
  saveProgress();

  if(stepIndex + 1 >= currentChallenge.steps.length) {
    completeChallenge();
  } else {
    showQuestion();
  }
}

// Ø¥ØªÙ…Ø§Ù… Ø§Ù„ØªØ­Ø¯ÙŠ ÙˆÙ…Ù†Ø­ Ù…ÙŠØ¯Ø§Ù„ÙŠØ© ÙˆÙ†Ù‚Ø§Ø·
function completeChallenge() {
  challengeProgress[currentChallenge.id].done = true;
  saveProgress();
  showNotification(`ğŸ‰ ØªÙ‡Ø§Ù†ÙŠÙ†Ø§! Ø£ÙƒÙ…Ù„Øª ØªØ­Ø¯ÙŠ "${currentChallenge.title}" ÙˆØ­ØµÙ„Øª Ø¹Ù„Ù‰ ${currentChallenge.reward}`);
  renderChallenges();
  goBackToList();
}

// Ø¥Ø´Ø¹Ø§Ø±
function showNotification(msg) {
  notifications.textContent = msg;
  notifications.style.display = 'block';
  setTimeout(() => {
    notifications.style.display = 'none';
  }, 7000);
}

// Ø§Ù„Ø¹ÙˆØ¯Ø© Ù„Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„ØªØ­Ø¯ÙŠØ§Øª
backToListBtn.onclick = () => {
  goBackToList();
}

function goBackToList() {
  challengeArea.style.display = 'none';
  challengeListDiv.style.display = 'flex';
  currentChallenge = null;
}

// Ù„ÙˆØ­Ø© Ø§Ù„Ù…ØªØµØ¯Ø±ÙŠÙ† (Ø­Ø³Ø¨ Ø¹Ø¯Ø¯ Ø§Ù„ØªØ­Ø¯ÙŠØ§Øª Ø§Ù„Ù…ÙƒØªÙ…Ù„Ø©)
function renderLeaderboard() {
  let scores = [];
  for(let ch of challenges) {
    const prog = challengeProgress[ch.id];
    if(prog && prog.done) {
      scores.push({title: ch.title, points: 10, medal: ch.reward});
    }
  }
  scores.sort((a,b) => b.points - a.points);

  if(scores.length === 0) {
    leaderboardList.innerHTML = "<li>Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ù…ØªØµØ¯Ø±ÙŠÙ† Ø¨Ø¹Ø¯.</li>";
    return;
  }
  leaderboardList.innerHTML = '';
  scores.forEach(s => {
    leaderboardList.insertAdjacentHTML('beforeend', `<li>${s.title} - Ù†Ù‚Ø§Ø·: ${s.points} - ${s.medal}</li>`);
  });
}

renderChallenges();
</script>

</body>
</html>
